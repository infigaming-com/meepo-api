syntax = "proto3";

package api.backoffice.service.v1;

import "google/api/annotations.proto";
import "infra/service/v1/email_domain.proto";

option go_package = "github.com/infigaming-com/meepo-api/backoffice/service/v1;v1";
option java_multiple_files = true;
option java_package = "api.backoffice.service.v1";

service BackofficeEmailDomain {
    rpc BindOperatorEmailDomain(BindOperatorEmailDomainRequest) returns (BindOperatorEmailDomainResponse) {
        option (google.api.http) = {
            post: "/v1/backoffice/email-domain/bind"
            body: "*"
        };
    }
    
    rpc GetOperatorEmailDomainBinding(GetOperatorEmailDomainBindingRequest) returns (GetOperatorEmailDomainBindingResponse) {
        option (google.api.http) = {
            post: "/v1/backoffice/email-domain/get"
            body: "*"
        };
    }
    
    rpc RetryOperatorEmailDomainVerification(RetryOperatorEmailDomainVerificationRequest) returns (RetryOperatorEmailDomainVerificationResponse) {
        option (google.api.http) = {
            post: "/v1/backoffice/email-domain/retry-verification"
            body: "*"
        };
    }
    
    rpc DeleteOperatorEmailDomainBinding(DeleteOperatorEmailDomainBindingRequest) returns (DeleteOperatorEmailDomainBindingResponse) {
        option (google.api.http) = {
            post: "/v1/backoffice/email-domain/delete"
            body: "*"
        };
    }
    
    rpc ListOperatorEmailDomainBindings(ListOperatorEmailDomainBindingsRequest) returns (ListOperatorEmailDomainBindingsResponse) {
        option (google.api.http) = {
            post: "/v1/backoffice/email-domain/list"
            body: "*"
        };
    }
}

message BindOperatorEmailDomainRequest {
    string domain = 1;
    string email_local_part = 2;  // e.g., "support", "noreply"
}

message BindOperatorEmailDomainResponse {
    api.infra.service.v1.EmailDomainBindingInfo binding = 1;
}

message GetOperatorEmailDomainBindingRequest {
    optional string domain = 1;  // Optional, if empty returns the operator's binding
}

message GetOperatorEmailDomainBindingResponse {
    api.infra.service.v1.EmailDomainBindingInfo binding = 1;
}

message RetryOperatorEmailDomainVerificationRequest {
    string domain = 1;
}

message RetryOperatorEmailDomainVerificationResponse {
    api.infra.service.v1.EmailDomainBindingInfo binding = 1;
}

message DeleteOperatorEmailDomainBindingRequest {
    string domain = 1;
}

message DeleteOperatorEmailDomainBindingResponse {}

message ListOperatorEmailDomainBindingsRequest {
    optional string status = 1;
    optional int32 page = 2;
    optional int32 page_size = 3;
}

message ListOperatorEmailDomainBindingsResponse {
    repeated api.infra.service.v1.EmailDomainBindingInfo bindings = 1;
    int32 total = 2;
    int32 page = 3;
    int32 page_size = 4;
}
