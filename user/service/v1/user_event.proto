syntax = "proto3";

package api.user.service.v1;

import "common/common.proto";

option go_package = "github.com/infigaming-com/meepo-api/user/service/v1;v1";
option java_multiple_files = true;
option java_package = "api.user.service.v1";

// User service provides authentication and user management functionality.
service UserEvent {
	rpc Event (EventRequest) returns (EventResponse) {}	
}

message EventRequest {
	string subscription_id = 1;
	bytes event_data = 2;
	string message_id = 3;
}

message EventResponse {}

// AddUserEvent is emitted when a player user is created.
message AddUserEvent {
	int64 user_id = 1;
	int64 operator_id = 2;
	int64 company_operator_id = 3;
	int64 retailer_operator_id = 4;
	int64 system_operator_id = 5;
	string username = 6;
	string email = 7;
	string mobile = 8;
	int32 role_id = 9;
	optional string registration_url = 10; // combined both campaign url and referral code
	string country = 11;
	int64 registered_at = 12;
	string default_currency = 13; // passed from frontend, related to country
}

// AddOperatorEvent is emitted when a operator is created.
message AddOperatorEvent {
	int64 real_operator_id = 1;
	int64 operator_id = 2;
	int64 company_operator_id = 3;
	int64 retailer_operator_id = 4;
	int64 system_operator_id = 5;
	string operator_type = 6;
	string operator_name = 7;
	string reporting_currency = 8;
	repeated string supporting_currencies = 9;
}

// UserStatusUpdateEvent is emitted when user status fields are updated.
// Fields: login_banned, withdraw_banned, game_banned, locked, kyc_level
message UserStatusUpdateEvent {
	int64 user_id = 1;
	api.common.OperatorContext operator_context = 2;
	string field = 3;  // field name that was updated
	string old_value = 4;
	string new_value = 5;
	int64 updated_at = 6;
}
